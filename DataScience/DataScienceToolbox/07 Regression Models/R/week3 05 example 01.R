n <- 500
x <- seq(0, 4*pi, length=n)
y <- sin(x) + rnorm(n, sd=.3)
knots <- seq(0, 8*pi, length=20)
splineTerms <- sapply(knots, function(knot) (x > knot) * (x-knot)^2)
xMat <- cbind(1, x, x^2, splineTerms)
yhat <- predict(lm(y~xMat-1))
plot(x, y, frame=FALSE, pch=21, bg="lightblue", cex=2)
lines(x, yhat, col="red", lwd=2)